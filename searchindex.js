Search.setIndex({docnames:["index","security-spec","tdx-guest-hardening"],envversion:53,filenames:["index.rst","security-spec.rst","tdx-guest-hardening.rst"],objects:{},objnames:{},objtypes:{},terms:{"060b":1,"062f":1,"0d5cd17f4537dbc185d647f6e80b6ab22098cf99":2,"0x10":1,"0x15":1,"0x16":1,"0x17":1,"0x18":1,"0x1a":1,"0x1b":1,"0x1f":1,"0x2":1,"0x3f8":1,"0x3f9":1,"0x3fa":1,"0x3fd":1,"0x4":1,"0x40000000":1,"0x400000ff":1,"0x5":1,"0x6":1,"0x600":1,"0x62f":1,"0x70":1,"0x71":1,"0x80000002":1,"0x80000005":1,"0x80000006":1,"0x80000007":1,"0x9":1,"0xb":1,"0xc":1,"0xcf8":1,"0xcff":1,"0xf":1,"100k":2,"250k":2,"2mb":1,"64_to_cpu":2,"9pnet_virtio":2,"boolean":2,"byte":[1,2],"case":[1,2],"catch":2,"default":[1,2],"final":2,"function":1,"import":[1,2],"int":2,"long":2,"new":[1,2],"public":1,"return":[1,2],"static":1,"try":[1,2],"while":[1,2],But:1,DoS:1,For:[1,2],Not:1,One:1,QoS:1,TLS:1,The:[1,2],Then:1,There:[1,2],These:[1,2],Use:2,Using:[1,2],__iomem:1,__tdx_fuzz:2,_dev_info:2,_dev_warn:2,_results_analyz:2,_results_new:2,_results_old:2,_tdfl:2,abl:[1,2],about:1,abov:[1,2],absenc:2,abus:1,accept:[1,2],accessor:2,accident:2,accord:1,accuraci:2,achiev:2,acpi:2,acpi_init:2,acpi_pm:1,acrn:2,across:1,act:2,action:1,activ:[1,2],actual:[1,2],add:[1,2],added:[1,2],adding:2,addit:[1,2],addition:[1,2],addr2lin:2,address:[1,2],adequ:2,adjust:2,adopt:2,advanc:[1,2],affect:[1,2],after:[1,2],again:[1,2],against:2,agent:[1,2],aim:1,albeit:2,algorithm:2,alias:1,all:[1,2],alloc:2,allow:[1,2],almost:1,alreadi:[1,2],also:[1,2],altern:[1,2],alwai:2,amd:[1,2],aml:1,amount:2,analysi:[1,2],andi:1,ani:[1,2],annot:1,anoth:[1,2],anymor:1,anyth:2,anywai:1,apart:1,api:2,apic:2,applic:[1,2],approach:[1,2],appropri:2,arbitrari:1,arch:[1,2],arch_cap:1,architectur:[1,2],area:[1,2],argument:[1,2],around:[1,2],arrang:2,asm:1,aspect:[1,2],assign:2,assist:2,assum:1,atom:1,attack:1,attempt:[1,2],attent:1,attest:[1,2],attribut:1,audienc:0,audit:1,aug:1,augment:2,authent:1,author:[1,2],auto:1,autom:2,automat:2,avail:2,avoid:[1,2],back:[1,2],baselin:2,bash:2,becaus:[1,2],been:[1,2],befor:[1,2],begin:2,behavior:1,behind:2,being:[1,2],below:[1,2],benign:2,best:2,better:1,between:[1,2],beyond:2,bia:2,big:2,biggest:2,binari:[1,2],binit:2,bio:2,bit:[1,2],bitdefend:2,bitmap:1,bkc:2,blob:2,block:[1,2],boost:1,boot:1,bootload:2,bootstrap:2,both:[1,2],bound:[1,2],brand:1,breakpoint:2,bridg:1,buffer:2,bug:2,build:[1,2],built:[1,2],bulk:2,bus:[1,2],cach:1,calcul:2,call:[1,2],caller:2,campaign:2,can:[1,2],candid:2,cannot:[1,2],captur:2,care:1,carefulli:1,categori:2,caus:[1,2],ccc:[1,2],celadon:[0,1,2],central:1,certain:[1,2],certainli:1,cf8:1,cha20:1,cha:1,challeng:2,chanc:1,chang:[1,2],channel:1,chassi:1,check:[1,2],choos:1,chosen:2,chunk:1,circumv:1,classifi:2,clear:[1,2],clock:2,cloud:1,codebas:[1,2],collect:2,com1:1,com:[1,2],combin:2,come:[1,2],command:2,comment:[1,2],commit:2,common:[1,2],commun:2,compil:[1,2],complet:2,complex:[1,2],compon:2,comput:1,conceptu:2,concern:[1,2],concret:2,condit:2,confidenti:1,config_random_trust_cpu:1,config_tdx_fuzz_harness_earlyboot:2,config_tdx_fuzz_harness_non:2,config_tdx_fuzz_kafl_virtio:2,configur:[1,2],confirm:2,conform:1,connect:2,consequ:2,consid:[1,2],consider:1,consist:2,consol:[1,2],consum:[1,2],contain:[1,2],content:[1,2],context:2,continu:[1,2],contribut:2,contributor:[1,2],control:2,convert:1,core:[0,1,2],corpu:2,correct:2,correspond:2,corrupt:1,could:1,count:1,cov:2,cover:[1,2],coverag:2,cppc:1,cpu:[1,2],cpu_khz_from_cpuid:1,cpuid:2,craft:1,creat:2,criteria:2,critic:1,cross:2,crucial:2,cryptograph:1,current:[1,2],custom:[1,2],dam:[1,2],data:[1,2],debug:[1,2],debugf:2,debugmod:1,decid:[1,2],decis:2,decod:1,decompress:2,decompressor:1,decrypt:1,dedic:2,defin:[1,2],definit:2,degre:1,delai:[1,2],deliveri:1,denial:1,depend:2,deplet:1,deploy:2,depth:1,describ:[1,2],descript:2,descriptor:1,design:[1,2],desir:[1,2],detail:[0,1],detect:[1,2],determin:2,determinist:[1,2],dev:[1,2],develop:[1,2],devic:2,devtool:2,diagnost:2,differ:1,difficult:2,direct:[1,2],directli:[1,2],directori:2,disabl:1,disabledg:1,disallow:1,discard:2,discourag:1,discoveri:1,disk:[1,2],divid:2,djb2:2,dmar:1,dmcrypt:1,do_bas:2,document:1,doe:[1,2],doing:[1,2],doinitcal:2,doinitcalls_acpi:2,doinitcalls_level_4:2,doinitcalls_level_x:2,doinitcalls_pci:2,doinitcalls_virtio:2,don:1,done:2,doubl:1,doubt:1,download:2,downsid:2,driver:2,drng:1,drop:2,dsdt:[1,2],due:[1,2],durat:2,dure:[1,2],each:[1,2],earli:[1,2],early_pci_serial_init:2,earlyboot:2,easi:2,easili:2,edg:2,effect:[1,2],effort:[1,2],either:[1,2],elena:[1,2],els:2,emul:2,enabl:[1,2],encompass:2,encrypt:1,end:[1,2],enforc:1,enhanc:2,enough:[1,2],ensur:[1,2],entir:2,entiti:1,entri:[1,2],entropi:1,enumer:1,environ:2,environment:2,eoi:1,ept:[1,2],equival:1,error:[1,2],escal:1,escap:2,especi:1,essenti:1,establish:2,etc:[1,2],even:[1,2],event:[1,2],eventu:2,everi:2,exact:[1,2],exampl:[1,2],except:[1,2],exclud:2,execut:[1,2],exercis:2,exist:[1,2],existing_smatch_audit_result:2,exit:2,expect:[1,2],explain:[1,2],explicit:1,explicitli:1,exploit:1,expos:[1,2],express:2,extend:[1,2],extern:[1,2],extract:2,fac:[1,2],facilit:2,facp:[1,2],fact:2,factum:2,fail:1,failur:1,fake:2,fall:1,fallback:1,far:2,fast:[1,2],fault:[1,2],featur:1,feed:2,feedback:2,field:1,figur:[1,2],file:[1,2],filesystem:2,filter:1,filtered_smatch_warn:2,find:1,finish:2,firmwar:[1,2],first:[1,2],fix:2,flag:[1,2],flash:[0,1,2],flexibl:2,focus:2,folder:2,follow:[1,2],forc:1,forev:1,form:2,format:1,fortun:2,found:2,foundat:1,four:2,frame:2,framework:1,free:1,frequenc:1,frequent:2,fresh:1,from:[1,2],frontend:2,full:1,full_boot:2,fulli:[1,2],further:[1,2],futur:[1,2],fuzz:1,fuzzer_func_har:2,gap:1,gather:2,gener:[1,2],get:[1,2],ghidra:2,github:2,gitlab:2,given:[1,2],goal:1,goe:[1,2],going:1,good:2,gpa:1,gpe0_blk:1,granular:1,grei:2,guarante:[1,2],guest:0,guestto:1,guid:[1,2],guidanc:2,had:1,halt_loop:2,handl:[1,2],handler:[1,2],hang:2,happen:[1,2],hard:2,harden:0,hardwar:1,harmless:1,harnes:2,has:[1,2],hash:[1,2],have:[1,2],help:[1,2],helper:2,here:[1,2],high:2,higher:[1,2],highli:1,highlight:2,hint:1,hole:1,host:2,hot:1,how:1,howev:[1,2],hprintf_xx:2,http:[1,2],hybrid:1,hypercal:2,hyperv:2,hypervisor:[1,2],ia32_mtrr_:1,ia32_vmx_:1,icr:1,icri:2,idea:2,ideal:[1,2],identif:1,identifi:2,ids:2,imag:1,immedi:2,implement:1,implementsg:2,impli:[1,2],implic:1,imposs:2,improv:2,inabl:2,inb:2,includ:[1,2],incorrect:1,inde:2,independ:[1,2],index:[1,2],indic:[1,2],indirect:1,individu:[1,2],industri:1,influenc:1,info:[1,2],inform:[1,2],init:2,initcal:1,initi:[1,2],initrd:2,inject:[1,2],input:[1,2],insert:1,insid:2,instead:1,instruct:1,instrument:[1,2],integr:1,intellab:2,intend:1,intens:2,interact:[1,2],intermedi:2,intern:[1,2],interpret:1,interrupt:1,introduc:1,introspect:2,invalid:2,invoc:[1,2],invok:[1,2],involv:2,io_apic_get_pci_irq_vector:2,iomap:1,ioremap_cach:1,irq:2,isa:1,issu:2,item:2,iter:2,its:[1,2],itself:[1,2],jiffi:1,just:[1,2],kafl_gui:2,kasan:2,kasan_report:2,kaslr:2,keep:[1,2],kei:[1,2],kernel:0,kernel_boot_param:2,kernel_build_directori:2,keyword:2,kind:1,kleen:1,knowledg:2,known:[1,2],kretprob:2,kvm:2,kvm_feature_async_pf:1,kvm_feature_async_pf_int:1,kvm_feature_async_pf_vmexit:1,kvm_feature_clocksourc:1,kvm_feature_clocksource2:1,kvm_feature_mmu_op:1,kvm_feature_msi_ext_dest_id:1,kvm_feature_nop_io_delai:1,kvm_feature_poll_control:1,kvm_feature_pv_eoi:1,kvm_feature_pv_sched_yield:1,kvm_feature_pv_send_ipi:1,kvm_feature_pv_tlb_flush:1,kvm_feature_pv_unhalt:1,kvm_feature_steal_tim:1,kvm_hc_clock_pair:1,kvm_hc_kick_cpu:1,kvm_hc_sched_yield:1,kvm_hc_send_ipi:1,kvm_hints_realtim:1,kvmclock:1,labor:2,larg:[1,2],larger:1,later:[1,2],latter:2,launch:2,launcher:2,layer:2,lbr:1,lead:[1,2],leaf:1,least:2,leav:2,left:1,legaci:2,lengyel:2,let:1,level:[1,2],leverag:[1,2],lifecycl:2,like:[1,2],limit:[1,2],line:2,link:2,linux:0,list:2,load:2,loader:[1,2],local:[1,2],locat:2,lockdown:1,log_crash:2,log_hprintf:2,logic:[1,2],look:2,loop:[1,2],lost:1,lot:1,low:[1,2],lst:2,ltp:2,luk:1,machin:[1,2],macro:[1,2],made:[1,2],mai:[1,2],main:[1,2],mainli:1,mainlin:2,maintain:2,major:1,make:[1,2],malform:2,malici:[1,2],manag:2,mani:[1,2],manner:2,manual:1,map:2,mark:[1,2],master:2,match:[1,2],mc146818:1,mcfg:1,mean:2,measur:[1,2],mechan:1,mem:1,mention:[1,2],mere:2,met:2,method:[1,2],methodolog:2,mgmt:1,might:[1,2],mind:2,minim:1,minimum:2,miscellan:2,miss:[1,2],mmu:2,mode:[1,2],model:[0,2],modern:[1,2],modifi:2,monitor:[1,2],monoton:1,more:[1,2],moreov:2,most:[1,2],mostli:1,mount:1,move:1,movidiu:[0,1,2],msr:2,much:2,multi:1,must:[1,2],mutat:2,mvp:2,mwait:1,my_funct:2,name:2,native_read_msr:2,natur:2,nearli:1,necessarili:[1,2],need:2,neither:2,net:[1,2],netperf:2,network:[0,1,2],neural:[0,1,2],never:1,next:[1,2],non:[1,2],none:2,nop:1,nor:2,normal:[1,2],northbridg:2,note:[1,2],notif:2,notifi:1,now:1,nowadai:1,nuc:[0,1,2],number:2,nyx:2,object:[1,2],observ:2,obsolet:1,obtain:[1,2],obviou:2,offer:2,offset:2,often:2,old:1,omit:1,onc:[1,2],one:[1,2],ones:[1,2],onli:[1,2],open:[1,2],oper:1,option:1,orang:2,order:2,organ:1,origin:2,osterlund:2,other:2,our:2,out:[1,2],outlin:[1,2],output:[1,2],outsid:1,over:[1,2],overal:2,overlap:1,overrid:[1,2],overridden:1,overview:0,own:[1,2],page:2,paid:1,panic:2,parallel:2,paramet:[1,2],paravirt:2,pars:[1,2],part:[1,2],partial:2,particular:[1,2],pass:[1,2],passthrough:1,patch:2,path:[1,2],paus:2,payload:2,pci_bu:2,pci_read_config:2,pci_read_config_byt:2,pci_swizzle_interrupt_pin:2,pdf:[1,2],pend:1,peopl:1,per:1,perf_ev:1,perform:1,permiss:2,phase:2,physic:2,pin:2,pio:2,pirq_enable_irq:2,place:[1,2],plan:1,platform:[0,1,2],pleas:2,pm1a_cnt_blk:1,pm1a_evt_blk:1,pm_tmr:1,point:[1,2],pointer:[1,2],pool:1,popul:1,port:2,portabl:1,portio:2,portion:1,possibl:[1,2],post:[1,2],post_trap:2,postfix:2,potenti:[1,2],power:1,practic:2,pre:1,predefin:2,prefer:1,presenc:2,present:[1,2],prevent:[1,2],previou:2,previous:1,primari:[1,2],principl:[1,2],print:1,printk:2,printout:1,prioriti:1,privileg:1,prng:1,problem:[1,2],problemat:2,proc:1,procedur:2,process:[1,2],process_smatch_output:2,processor:1,produc:2,program:2,programmat:2,progress:1,prohibit:1,project:2,promin:1,propag:2,protect:2,protocol:[1,2],provid:[1,2],publish:2,pure:1,purpos:[0,1],put:2,python3:2,python:2,qemu:[1,2],quantifi:2,question:2,queue:1,quickli:1,quirk:2,quot:1,rais:1,ram:2,random:2,rang:[1,2],rather:1,rc1:2,reach:2,reachabl:2,read:[1,2],readb:2,real:1,reason:[1,2],receiv:[1,2],recent:1,recommend:[1,2],recov:2,recoveri:2,reduc:2,reentri:1,refer:[1,2],region:1,regist:[1,2],registr:2,regular:2,reject:1,rel:2,relat:[1,2],relev:[1,2],reli:1,reliabl:1,remain:[1,2],remot:[1,2],remov:[1,2],repeatedli:2,repetit:2,report:2,reproduc:2,request:2,requir:1,resctrl:1,research:2,reserv:1,reset:2,reshetova:[1,2],resid:[1,2],resourc:2,respect:1,respons:[1,2],rest:1,rest_init:2,restor:[1,2],restrict:2,result:1,retri:1,retriev:1,rev:[1,2],rewrit:2,right:2,ring0:2,ring3:2,ring:[1,2],risk:1,robust:2,root:2,rootf:2,rough:2,routin:[1,2],rst:1,rtc:1,rtit_:1,rtmr:2,run:1,run_experi:2,runtim:1,safe:2,safest:1,same:[1,2],sampl:2,sample_output:2,sanit:[1,2],save:1,sbin:2,scale:2,scan:2,scenario:2,schedul:1,scheme:1,schulz:2,scope:1,script:[1,2],seam:1,search:2,sebastian:2,second:2,secret:1,section:[1,2],secur:[0,2],see:[1,2],seed:1,seem:1,select:2,sept_ve_dis:1,sequenc:1,sequenti:2,serial:1,server:1,servic:1,set:[1,2],setp:2,setup:1,sev:1,sever:[1,2],sharedir:2,sharedir_templ:2,shell:2,shift:2,shm:2,should:[1,2],show:1,shown:[1,2],side:1,sign:1,signal:2,signific:[1,2],significantli:2,sigsegv:1,similar:[1,2],similarli:2,simpl:1,sinc:[1,2],situat:[1,2],small:[1,2],smatch_match:2,smatch_script:2,smatch_warn:2,smp_call_funct:1,snapshot:2,snippet:2,soc:[0,1,2],softwar:2,solid:1,solut:1,some:[1,2],someth:1,sometim:2,sophist:2,sound:2,sourc:[1,2],sourceforg:2,spars:1,spec:1,special:1,specif:[0,2],specifi:2,spinlock:1,split:1,stack:[1,2],stacktrac:2,stage:2,standard:1,start:2,start_kernel:2,startup:1,state:[1,2],statist:2,status:2,steffen:2,step:[1,2],still:1,stop:[1,2],store:2,strategi:[0,1],stress:2,string:1,stronger:2,strongli:[1,2],structur:[1,2],stub:1,stuck:2,style:2,sub:2,subsequ:1,subset:1,subsystem:2,succe:1,success:2,successfulli:2,suffici:2,suggest:2,suit:2,suppli:2,support:[1,2],sure:[1,2],surfac:1,svkl:[1,2],synchron:1,sys:1,syscal:[1,2],sysret:1,system:[1,2],systemat:1,syzkal:2,tabl:2,taint:[1,2],taint_conf_no_lockdown:1,take:[1,2],taken:2,tama:2,target:0,task:[1,2],tbd:2,tcb:1,td_param:1,tdaccept:1,tdfl:2,tdg:1,tdg_fuzz_en:2,tdg_fuzz_ev:2,tdh:1,tdvf:2,tdvmcall:2,tdx:2,tdx_allowed_driv:2,tdx_fuzz:2,tdx_fuzz_en:2,tdx_fuzz_ev:2,techniqu:[1,2],technolog:[1,2],tenant:1,termin:2,test:[1,2],test_kernel:2,than:1,thei:[1,2],them:[1,2],themselv:1,theori:1,therefor:[1,2],thermal:1,thi:[1,2],those:[1,2],thread:2,threat:[0,2],three:[1,2],throttl:1,through:2,thu:2,time:1,timeout:[1,2],tlb:1,tme:1,todo:2,togeth:2,tool:[0,1,2],top:2,topolog:1,total:2,toward:[1,2],trace:2,track:[1,2],transfer:[1,2],transfer_result:2,translat:2,transmit:1,transplant:2,transport:1,trap:2,trigger:[1,2],trivial:1,truli:1,turn:1,two:[1,2],txt:2,txt_filter:2,type:[1,2],typic:2,ubsan:2,uchar:2,uefi:1,ultim:2,unauthor:1,unclassifi:2,uncor:1,under:[1,2],underli:2,underpin:2,understand:[1,2],unencrypt:1,unharden:1,uniqu:[1,2],unless:2,unmap:2,unneed:2,unput:2,unrecover:2,unsecur:2,until:2,untrust:[1,2],unus:1,upon:1,urandom:1,usag:2,use:[1,2],use_ghidra:2,used:[1,2],user:2,user_read_:2,user_tdfl:2,usermod:2,userspac:[1,2],uses:[1,2],using:[1,2],usual:[1,2],util:2,valid:[1,2],valu:[1,2],variabl:2,variou:[1,2],vcpu:[1,2],vector:[1,2],vendor:2,veri:[1,2],verif:2,verifi:[1,2],version:2,vfat:1,via:[1,2],view:2,violat:[1,2],virt:1,virtio16:2,virtio_blk:2,virtio_consol:2,virtio_console_init:2,virtio_net:2,virtio_to_cpu:1,virtioxx_to_cpu:2,virtqueu:1,virtual:[1,2],vmbu:1,vmi:2,vmm:[1,2],volum:1,vsock:1,vulner:1,wai:[1,2],wait:1,wall:1,want:[1,2],warn:[1,2],watch:[0,1,2],watchdog:1,well:[1,2],were:2,what:[1,2],when:[1,2],whenev:[1,2],where:[1,2],whether:2,which:[1,2],whole:[1,2],wiki:2,window:1,within:[1,2],without:[1,2],withstand:1,won:1,work:[1,2],workdir:2,worker:2,would:[1,2],wrapper:[1,2],write:[1,2],written:2,www:[1,2],x86:[1,2],x86_feature_aperfmperf:2,x86_feature_cqm_llc:[1,2],x86_feature_mba:1,x86_feature_mc:[1,2],x86_feature_mtrr:[1,2],x86_feature_tm:[1,2],x86_feature_tsc_reli:1,xen:2,xsdt:[1,2],yet:2,you:2,your:2,zero:1},titles:["Intel\u00ae Trust Domain Extension Documentation","Intel\u00ae Trust Domain Extension Linux* Guest Kernel Security Specification","Intel\u00ae Trust Domain Extension Guest Linux* Kernel Hardening Strategy"],titleterms:{"function":2,"static":2,access:[1,2],acpi:1,against:1,alloc:1,analyz:2,apic:1,appli:2,attack:2,audienc:2,audit:2,base:[1,2],basic:2,bio:1,blind:2,boot:2,check_host_input:2,code:[1,2],command:1,commun:1,config:[1,2],control:1,convers:1,cpuid:1,crash:2,declar:1,detail:2,devic:1,differ:2,disabl:2,dma:2,document:[0,2],domain:[0,1,2],driven:2,driver:1,explicitli:2,extens:[0,1,2],extra:2,featur:2,filter:2,find:2,full:2,fuzz:2,fuzzer:2,goal:2,guest:[1,2],har:2,harden:[1,2],hook:2,host:1,how:2,hypercal:1,implement:2,initrd:1,insecur:1,insid:1,instruct:2,intel:[0,1,2],interfac:[1,2],iommu:1,ipi:1,kafl:2,kernel:[1,2],kvm:1,lazi:1,leav:1,legaci:1,line:1,linux:[1,2],list:1,load:1,log:2,manag:1,manual:2,map:1,mechan:2,memori:[1,2],methodolog:1,minim:2,mmio:[1,2],model:1,modul:1,msr:1,need:1,oper:2,opt:2,option:2,other:1,overal:1,overview:2,page:1,panic:1,pattern:2,pci:[1,2],perfmon:1,perform:2,port:1,privat:1,probe:1,program:1,protect:1,proxi:1,purpos:2,random:1,rdrand:1,rdseed:1,region:2,requir:2,resourc:1,result:2,rng:1,run:2,runtim:2,safe:1,safeti:1,secur:1,setup:2,share:[1,2],simpl:2,singl:2,smatch:2,space:[1,2],specif:1,statu:2,stimulu:2,storag:1,strategi:2,subsystem:1,summari:1,suppli:1,surfac:2,sysf:1,tabl:1,target:2,tdg:2,tdvf:1,tdvmcall:1,tdx:1,threat:1,through:1,time:2,timer:1,tree:2,trust:[0,1,2],tsc:1,unclear:1,unsaf:1,user:1,virtio:[1,2],vmcall:2,workflow:2,x2apic:1,xapic:1}})